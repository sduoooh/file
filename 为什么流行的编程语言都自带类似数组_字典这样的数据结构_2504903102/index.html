<div class="CollectionItem"><h1>为什么流行的编程语言都自带类似数组/字典这样的数据结构？</h1><span class="RichText ztext CopyrightRichText-richText css-1g0fqss" itemprop="text" options="[object Object]"><p data-first-child="" data-pid="blLKzvtX">假设我们希望把尽可能多的数据结构变成流数据传输给他人，我们也会考虑数据结构最基本的最重要的构成成分应该是什么。</p><p data-pid="ZeWJ4-lX"><b>从结构上看，所有的数据（data）最终都可以分解成三种类型</b>：</p><blockquote data-pid="f1d3UHIL">第一种类型是<b>标量</b>（scalar），也就是一个单独的字符串（string）或数字（numbers），比如"北京"这个单独的词。<br/>第二种类型是<b>序列</b>（sequence），也就是若干个相关的数据按照一定顺序并列在一起，又叫做数组（array）或列表（List），比如"北京，上海"。<br/>第三种类型是<b>映射</b>（mapping），也就是一个名/值对（Name/value），即数据有一个名称，还有一个与之相对应的值，这又称作散列（hash）或字典（dictionary），比如"首都：北京"。</blockquote><p data-pid="OeIa_wQc">来自yaml文档。</p><a class="LinkCard new" data-draft-node="block" data-draft-type="link-card" data-text="https://www.ruanyifeng.com/blog/2009/05/data_types_and_json.html" href="https://link.zhihu.com/?target=https%3A//www.ruanyifeng.com/blog/2009/05/data_types_and_json.html" target="_blank"><span class="LinkCard-contents"><span class="LinkCard-title loading" data-text="true"></span><span class="LinkCard-desc loading"></span></span><span class="LinkCard-image LinkCard-image--default"></span></a><p data-pid="wE9cBsQL">从语言设计者的角度出发，我们也需要考虑最基本的数据结构的基石是什么。</p><p data-pid="jxtTJ8Uu">表是 Lua 中唯一可以帮助我们创建不同类型（如数组和字典）的数据结构。Lua 使用关联数组，它不仅可以用数字索引，还可以用除 nil 之外的字符串来索引。表格没有固定大小，可以根据我们的需要增长。Lua 在所有表示中都使用表，包括包的表示。当我们访问 string.format 方法时，这意味着我们正在访问 string 包中可用的 format 函数。然后Lua用table实现五种常见数据结构的方法:</p><a class="LinkCard new" data-draft-node="block" data-draft-type="link-card" data-text="Other 5 data structures implemented in LUA using table _lua" href="https://link.zhihu.com/?target=https%3A//topic.alibabacloud.com/a/other-5-data-structures-implemented-in-lua-using-table-_lua_8_8_20106616.html" target="_blank"><span class="LinkCard-contents"><span class="LinkCard-title loading" data-text="true"></span><span class="LinkCard-desc loading"></span></span><span class="LinkCard-image LinkCard-image--default"></span></a><blockquote data-pid="Yf5rXFZq">问题：使用哪种数据结构来实现数组？<br/>答：我们可以使用数组本身来实现数组。<br/>问题：使用哪种数据结构来实现堆栈？<br/>答：我们可以使用数组和链表来实现堆栈。<br/>问题：使用哪种数据结构来实现队列？<br/>答：我们可以使用数组、链表和堆栈来实现队列。<br/>问题：使用哪种数据结构来实现链接列表？<br/>答：我们可以使用结构体和指针来实现链接列表。<br/>问题：使用哪种数据结构来实现Tree？<br/>答：我们可以使用数组和链表来实现树。<br/>问题：使用哪种数据结构来实现图？<br/>答：我们可以使用邻接矩阵、邻接表和邻接集来实现 Graph。</blockquote><p data-pid="2s4qNjgb">table被称为object，它们既不是值也不是变量。Lua 之父说他看过资料table能构造其他所有数据结构，所以选择table。在 Lua 中，表是唯一的复合数据结构。</p><p data-pid="x0JZizN5">那么，字典是什么呢?Python中的字典是使用哈希表和 开放式地址 冲突解决方法构建的。更多数据结构的实现看这里</p><a class="LinkCard new" data-draft-node="block" data-draft-type="link-card" data-text="lua-users wiki: Data Structures" href="https://link.zhihu.com/?target=https%3A//lua-users.org/wiki/DataStructures" target="_blank"><span class="LinkCard-contents"><span class="LinkCard-title loading" data-text="true"></span><span class="LinkCard-desc loading"></span></span><span class="LinkCard-image LinkCard-image--default"></span></a><p data-pid="0aCx05Rv">直观理解，汇编令CPU调用ALU和CU等计算资源处理的数据，只要查询表中32/64位的指针地址key，根据预定的取值规则，从key对应存储结构中取出任意数据结构大小的value。甚至controller本身就是数据，图灵说编程就是设计指令跳转表。</p><hr/><p data-pid="-vnZ9pN7">上述说明题主的第二点确实成立，那么第一点是为什么呢，大部分语言为什么不全都实现呢？</p><ol><li data-pid="Lwf_THFm">假设你是语言设计者，get that shit done，跑起来再说，能懒为什么不懒?而且比如你实现的语言叫做Lua吧，当你用c写完table，你可以根据相关构造规则实现其他数据结构。此时，你可以用c写，也可以用Lua脚本写。那么你会选择烦死人的c吗？除非为了安全或者速度等特殊需求，写个c库暴露api。</li><li data-pid="ggoqM5MU">数据结构的实现不唯一，比如java/python可以用面向对象实现任意链接结构，多叉树等。不一定要用table。语言只要保证逻辑底层支持到位了，上层建筑是很自由的，用户可以根据自己的业务需求实现对应的数据结构。</li><li data-pid="YTkimD_6">数据结构有很多，根本实现不完。根据需要你可以随便自己设计一个来满足你的问题。因为不同业务需求中常用的数据结构和函数不同，比如跳表,线段树,手指树,红黑树...ACM中发明个数据结构不是稀罕事儿。更优雅的方法是设计一个抽象的图存储和处理方法，GADT。而不是针对语法树的图或者其他不同格式的图，我都重复编写相同功能不同细节的c-like代码。比如我把抽象的图算法提炼出来，每种格式的图都是monad包着的不同盒子，调用抽象的算法时自动拆包裹装包裹，就能compose出更多通用的功能。</li></ol><p data-pid="kCPUOe8u">一般，面对不同领域的语言，用cpp封装出的对应专用的数据结构和函数库，有时候也为了支持动态脚本反射JIT，我们就会实现一种领域特定语言。为了防止混淆，让我们给这些新语言起一个不同的名字来区分吧。Lisp的宏就不一样，你实现完一个DSL你一般不能称你发明了一种新语言，你只能说你发明了Lisp一种方言。</p><hr/><p data-pid="O4chulKa">从计算机考古学的角度来看，我认为这和 关系逻辑 <a class="internal" href="https://zhuanlan.zhihu.com/p/19945892">datalog</a> 纸带上的指令跳转表 Lisp 关系数据库 等相关。推荐阅读List processing是怎么组织从list到symbol list等数据结构的。</p><a class="LinkCard new" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-eabb6c604abd06398a8e15ea94a606fb_180x120.jpg" data-image-height="524" data-image-width="2014" data-text="Common Lisp 数据结构实现" href="https://link.zhihu.com/?target=https%3A//www.jianshu.com/p/9e465ca87a51" target="_blank"><span class="LinkCard-contents"><span class="LinkCard-title loading" data-text="true"></span><span class="LinkCard-desc loading"></span></span><span class="LinkCard-image LinkCard-image--default"></span></a><p data-pid="wGTajZlP">这大概就是Lisp's Revenge。</p><a class="LinkCard new" data-draft-node="block" data-draft-type="link-card" data-text="http://ruanyifeng.com/blog/2010/10/why_lisp_is_superior.html" href="https://link.zhihu.com/?target=http%3A//ruanyifeng.com/blog/2010/10/why_lisp_is_superior.html" target="_blank"><span class="LinkCard-contents"><span class="LinkCard-title loading" data-text="true"></span><span class="LinkCard-desc loading"></span></span><span class="LinkCard-image LinkCard-image--default"></span></a><p data-pid="r3-vfZW7">"格林斯潘第十定律"（Greenspun's Tenth Rule）：</p><blockquote data-pid="NGEST3hM">"任何C或Fortran程序复杂到一定程度之后，都会包含一个临时开发的、只有一半功能的、不完全符合规格的、到处都是bug的、运行速度很慢的Common Lisp实现。"</blockquote><a class="LinkCard new" data-draft-node="block" data-draft-type="link-card" data-image="https://pic3.zhimg.com/v2-0a78a9de071212ba775623fc33035bf2_180x120.jpg" data-image-height="600" data-image-width="1200" data-text="GitHub - kanaka/mal: mal - Make a Lisp" href="https://link.zhihu.com/?target=https%3A//github.com/kanaka/mal" target="_blank"><span class="LinkCard-contents"><span class="LinkCard-title loading" data-text="true"></span><span class="LinkCard-desc loading"></span></span><span class="LinkCard-image LinkCard-image--default"></span></a><p data-pid="TG3l9bMA">如果你创造了一种新语言，其中有car、cdr、cons、quote、cond、atom、eq这样的功能，还有一种把函数写成列表的表示方法，那么在它们的基础上，你完全可以推导出Lisp语言的所有其他部分。</p><hr/><p data-pid="T4sXOYSQ">如果你就在Soc/FPGA上实现:七个基本Lisp指令+Function2List机制(lambda匿名函数。FP闭包我认为本质也是复合数据结构。就像OOP打包的对象。只是FP主体是函数，适合动作复杂数据对象简单的情况，OOP反之)，你就实现了图灵完备的Lisp Machine计算模型。</p><p data-pid="Duqg8hFy">程序 = 数据结构 + 算法 </p><p data-pid="Iwa2zDXg">人造规则系统=数据抽象+过程抽象</p><hr/><p data-pid="QbJQv4jt">类似idris从高级类型编程语言到type checker的文章，想在这里蹲一下从逻辑角度研究GADT的文献。如果你知道什么文献从list到table到various data structure，从逻辑或者类型论出发理论推导或形式化描述，请务必狠狠踢我的屁股一下，谢谢! </p></span><link href="../style.css" rel="stylesheet"/><div class="ContentItem-time"><a href="https://www.zhihu.com/answer/2504903102" target="_blank"><span aria-label="发布于 2022-05-28 09:35" data-tooltip="发布于 2022-05-28 09:35">编辑于 2022-05-28 13:01</span></a>・IP 属地广东</div></div>